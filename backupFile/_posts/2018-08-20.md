---
layout: post
title : 2018-08-20
---


### [MsSql] How to Write a better Procedure

Capital letters for keywords and proper indentation. With todays code editors with syntax high lighting I don't see why you want to high light keywords with capital letters. The code editor will do that for you. And suggesting proper indentation is not really a tip to write a good stored procedure. It's common (coding) sense! So I don't think this one counts... Score (good-not really-bad advice IMHO): 0-1-0.

Use SQL-92 syntax for joins. If MS SQL server drops support for the old syntax this is good advice. Score: 1-1-0

Use as few variables as possible. The article mentions cache utilization as an argument. Sounds like premature optimization to me. I'd say use as many variables as makes sense to make the code most readable. If that turns out to be a problem, then you optimize. So in general I found this advice to be bad. Score: 1-1-1

Minimize usage of dynamic queries. Kudos to the article to pointing out how to minimize the bad of dynamic queries and I guess technically minimizing could mean zero but that is really the only good advice; don't use dynamic queries. So once again a bad, or at least misleading advice IMHO. Score: 1-1-2

Use fully qualified names. If you don't do this you might end up with some weird behavior so this is a good advice. Score: 2-1-2

Set NOCOUNT on. Good advice: Score: 3-1-2

Don't use sp_ prefix. Score: 4-1-2

KEEPFIXED PLAN. Learn from this article and use it correctly. Hard to argue with "learn something and use it right". Score: 5-1-2

Use select instead of set. Once again performance is mentioned as a motivator. However the potential bad side effects of using select rather than set are more important in my opinion. The problem with select is that the variable might not be set if a query returns no rows and the set gives you an error if the select returns more than one row. Read more about it here. I'd definitely prefer set over select. Score: 5-1-3

Compare the right thing in the where clause. This advice just confuses me. The article talks about what operators are the fastest and then refers to this page talking about preference. Even though the article is confusing on this point the basic idea is correct. For example using IN is generally faster than NOT IN. So I'll call this one a draw. Score: 5-2-3

Avoid OR in WHERE clause. This is good advise for good performance. Score: 6-2-3

Use CAST over Convert. CAST is SQL92 standard. Convert is not. Score: 7-2-3

Avoid distinct and order by. Once again this is common sense. Don't do things you don't need... Score: 7-3-3

Avoid cursors. This falls into the same category as dynamic queries to me. The only good advice is don't use cursors. Score: 7-3-4

Select only the columns you need. Common sense! Score: 7-4-4

Sub queries vs joins. Article lists a few good rule of thumbs. I think you should use whatever is most readable. Score: 8-4-4

Create table vs select into. Article points out important differences. Score: 9-4-4

Use variables instead of temporary tables. Score: 10-4-4

Use proper indexes. Score: 11-4-4

Use profiler. Many tips in the article suggest you do things to improve performance. But I think doing so before you know you have a problem is a waste of time and resources. So this advice is actually one of the best advices in the article. Score: 12-4-4

------

<div class="post_ct  " id="viewTypeSelector">






		<p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><strong style="color: rgb(0, 117, 200);font-size:12pt;" _foo="font-family: 돋움; color: rgb(0, 117, 200); font-size: 12pt; line-height: 1.5;"><span style="font-size:12pt;" _foo="font-family: 굴림, gulim; font-size: 12pt;">1.&nbsp;</span></strong><span style="color: rgb(0, 117, 200);" _foo="font-family: 굴림, gulim; color: rgb(0, 117, 200);"><span style="font-size:12pt;" _foo="font-size: 12pt; line-height: 24px; font-family: 굴림, gulim;"><b>좋은 저장프로시저&nbsp;작성을 위한&nbsp;팁</b></span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37); font-size: 10pt;"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="color: rgb(0, 158, 37); font-family: 굴림, gulim; font-size: 10pt;"><span style="color: rgb(0, 0, 0);" _foo="color: rgb(0, 0, 0);"></span></span></span><b style="" _foo="line-height: 1.5;"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37); font-size: 10pt;"><span style="font-size:10pt;" _foo="font-size: 10pt;">(1) 주석</span></span></b></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">작성자, 작성일, 최종</span></span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px;">수정자,&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">수정일</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">, 파라미터 설명,&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px;">사용예</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">등을 주석으로 명시한다. 차후&nbsp;저장프로시저 수정시에도 수정 내용을 명시한다.</span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37); font-size: 10pt;"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="color: rgb(0, 158, 37); font-family: 굴림, gulim; font-size: 10pt;"></span></span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">CREATE PROC [dbo].[spam_LoginProcess]</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">/*</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">////////////////////////////////////////////////////////////////////////</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">//</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 프로시져명 : 관리자모드 로그인 처리</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 작 성 자 : 홍길동(kildong@naver.com)</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 작 성 일 : 2016-01-17 PM 05:30</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 최종수정자 :&nbsp;</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 수 정 일 :&nbsp;</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 파 일 명 :&nbsp;</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// 사 용 예 : EXEC [dbo].[spam_LoginProcess] 'Test01', 'abc123!', '162.17.8.15', @v_RetVal OUTPUT<span style="" _foo="Apple-tab-span">  </span></span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">// N O T E :</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">//</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">////////////////////////////////////////////////////////////////////////</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">*/</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">(</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">@v_AdminId VARCHAR(32),<span style="" _foo="Apple-tab-span">     </span>-- 관리자모드 로그인 아이디</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">@v_PassWd VARCHAR(15),<span style="" _foo="Apple-tab-span">     </span>-- 관리자모드 로그인 패스워드</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">@v_LoginIp VARCHAR(15),<span style="" _foo="Apple-tab-span">     </span>-- 관리자 접속 IP</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">@v_RetVal INT OUTPUT,<span style="" _foo="Apple-tab-span">     </span>-- 처리코드(0/1/3/99 : 정상/존재X/계정만료/DB 오류)</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">)</span></span></p></td></tr></tbody></table><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37); font-size: 10pt;"><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="color: rgb(0, 158, 37); font-family: 굴림, gulim; font-size: 10pt;"><br></span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><b><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);"></span></span><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37); font-size: 10pt;"><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);"></span><span style="color: rgb(0, 158, 37);font-size:10pt;" _foo="color: rgb(0, 158, 37); font-family: 굴림, gulim; font-size: 10pt;">(2) SQL&nbsp;</span></span><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">키워드</span></span></b></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">가독성을 높이기 위해 SQL&nbsp;키워드는&nbsp;대문자로 작성한다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b></b></span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">[X]</span></span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">select * from&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_Member where&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">f_Idx = 101</span></p><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;"><br></span></span></p><p style="" _foo="line-height: 1.5;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[0]</span></p><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT * FROM&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_Member&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">WHERE&nbsp;f_Idx = 101</span></p></td></tr></tbody></table><p><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(3)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">SQL-92</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">항상 ANSI 92를 사용하도록 노력해야 한다.</span></span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">[X]</span></span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT * FROM&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_Member</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;a,&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_MemberDesc b</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">WHERE a.f_Idx = b.f_Idx</span></p><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;"><br></span></span></p><p style="" _foo="line-height: 1.5;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[0]</span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT * FROM&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_Member</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;a INNER JOIN&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">tbl_MemberDesc</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;b&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">ON&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">a.f_Idx = b.f_Idx</span></p></td></tr></tbody></table><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(4)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">변수</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">가능한 최소한으로 사용하여 캐쉬 공간에 여유를 주어야 한다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(5)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">동적 쿼리</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:10pt;" _foo="font-size: 10pt; line-height: 20px; font-family: 굴림, gulim;">저장프로시저는 실행 계획이 Plan 캐쉬에 캐싱된다.&nbsp;</span></span><span style="font-size:10pt;" _foo="font-size: 10pt; line-height: 20px; font-family: 굴림, gulim;">즉, 한번 컴파일되면 이것이 캐쉬에 저장되고, 재사용이 되면 될수록 재컴파일이 필요없기에 효율이 올라간다.</span></p><div style="" _foo="text-align: justify;"><div><span style="font-size:10pt;" _foo="font-size: 10pt; font-family: 굴림, gulim;">저장프로시저가 수정되거나&nbsp;</span><span style="font-size:10pt;" _foo="line-height: 1.5; font-size: 10pt; font-family: 굴림, gulim;">인덱스 통계가 재빌드되기 전까지는&nbsp;</span><span style="font-size:10pt;" _foo="font-size: 10pt; font-family: 굴림, gulim;">실행 계획이 캐시에 유지된다.&nbsp;하지만, 동적 쿼리는 시스템에 캐싱되지 않아 호출할 때마다 컴파일을 해야하고,&nbsp;</span><span style="font-size:10pt;" _foo="line-height: 1.5; font-size: 10pt; font-family: 굴림, gulim;">이것이 결국 서버의 성능을 떨어트리게 된다.</span></div><div>&nbsp;</div></div><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(6) 동적 쿼리 실행 :&nbsp;</span></b></span><span style="color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; color: rgb(0, 158, 37);"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;"><b>EXEC sp_EXECUTESQL,&nbsp;</b></span></span><b style="color: rgb(0, 158, 37);font-size:9pt;" _foo="color: rgb(0, 158, 37); font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px;">EXEC</b><b style="font-size:9pt;color: rgb(0, 158, 37);" _foo="font-size: 13.3333px; line-height: 20px; color: rgb(0, 158, 37); font-family: 굴림, gulim;">&nbsp;</b></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">EXEC SP_EXECUTESQL은 매개변수를 정의할 수 있고 이를 파라미터화 할 수 있기 때문에&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">쿼리문이 고정된 채 매개변수만 바뀌는 경우라면, 첫번째 실행에서 실행 계획을 캐싱, 재사용하게 된다.&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">이로 인해 EXEC()에 비해 많은 성능상 이득을 취할 수 있다.&nbsp;</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">따라서&nbsp;</span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:10pt;" _foo="font-size: 10pt;">어쩔 수 없이 동적 쿼리를 사용해야 한다면, EXEC보다&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">EXEC SP_EXECUTESQL</span><span style="font-size:10pt;" _foo="font-size: 10pt;">을 사용하도록 하자.</span></span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">[X]</span></span></p><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">&nbsp;NVARCHAR(4000);</span></span></p><div><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span></span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Idx INT</span></div><div><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;"><br></span></div><div><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SET&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Idx = 101</span></div><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SET&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;= "SELECT f_Name FROM tbl_Member WHERE f_Idx =&nbsp;" + CAST(VARCHAR(16) AS @v_Idx)</span></p><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">EXEC(</span></span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">)</span></p><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;"><br></span></span></p><p style="" _foo="line-height: 1.5;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[0]</span></p><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">&nbsp;NVARCHAR(4000);</span></span></p><div><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span></span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">@v_ExecParam&nbsp;NVARCHAR(1000);</span></span></div><div style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span></span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Idx INT</span></div><div style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">DECLARE&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Name VARCHAR(50)</span></div><div style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;"><br></span></div><div style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SET&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Idx = 101</span></div><div><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SET&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;=&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">"</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SELECT @v_InName =&nbsp;f_Name FROM tbl_Member WHERE f_Idx = @v_InIdx"</span></div><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SET&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_ExecParam</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">&nbsp;= N'</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_InIdx INT,&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_InName VARCHAR(50)&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">OUTPUT</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">'</span></p><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;"><br></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">EXEC SP_EXECUTESQL&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">@v_</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">SQL</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">, @</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">v_ExecParam</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">,&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_InIdx =&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Idx,&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_InName =&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">@v_Name</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">&nbsp;OUTPUT</span></p></td></tr></tbody></table><p><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(7)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">친숙한 전체 이름 사용</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">database_name.schema_name.table_name으로 사용을 해야 하며, CREATE PROCEDURE dbo.Your_Proc_name처럼 사용해야 한다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(8)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">SET NOCOUNT OFF</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">실행 결과 행은 네트워크 트래픽을 사용하게 되므로 주의해야 한다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(9)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">sp_ 접두어를 사용하지 않는다</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">sp_는 시스템 저장프로시저이기 때문에 sp_로 시작하는 프로시저는&nbsp;</span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">시스템&nbsp;데이터베이스(MASTER)를 조회하는 추가적 부담이 발생하고 만약&nbsp;시스템&nbsp;데이터베이스(MASTER)에 같은 이름의&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">프로시저가 있다면 이용자가 작성한 프로시저는 실행되지 않는다.</span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(10)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">SELECT 와 SET</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">서로 다른 여러 변수를 사용할 경우 SET보다&nbsp;</span></span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px;">SELECT가 성능상 좋다.</span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[X]</span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">SET @var1 = @var1 + 1</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">SET @var2 = @var2 - 1</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;"><br></span></span></p><p><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[0]</span></p><p style="font-size:9pt;" _foo="font-size: 13.3333px;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT @var1 = @var1 + 1, @var2 = @var2 - 1</span></p></td></tr></tbody></table><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(11)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">WHERE 연산자 필터링시 성능 순서</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">=, &gt;, &lt;, &gt;=, &lt;=, &lt;&gt;, !=, !&gt;, ! 순서대로 성능이 떨어진다.(가장 왼쪽이 성능이 좋다)</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(12)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">WHERE 연산자</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">Boolean(Yes/No)형 비교는 IN&nbsp;이나 NOT IN 보다 EXISTS 나 NOT&nbsp;</span></span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px;">EXISTS를 사용하라.</span></p><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p style="" _foo="line-height: 1.5;"><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">[X]</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;"></span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">SELECT name FROM teacher WHERE teacher_id IN (SELECT teacher_id FROM student)</span></span></p><p><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;"><br></span></p><p><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">[0]</span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">SELECT name FROM teacher WHERE EXISTS (SELECT 1 FROM student WHERE teacher.teacher_id = student.teacher_id)</span></span></p></td></tr></tbody></table><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><br></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(13)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">CAST 와 CONVERT</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">CONVERT보다 CAST를 쓰도록 한다. CAST는 ANSI-92지만 CONVERT는 MSSQL에서만 사용이 가능하다. 다만 DATETIME 데이타&nbsp;타입의 변형에는&nbsp;</span></span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; line-height: 1.5; font-size: 10pt;">CAST가 되지 않기 때문에&nbsp;</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; line-height: 1.5; font-size: 10pt;">CONVERT를 사용해야 한다.&nbsp;</span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(14)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">DISTINCT 와 ORDER BY</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">추가적인 데이터베이스&nbsp;</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">작업이 요구되기 때문에 성능상 좋지 않으므로,&nbsp;굳이 필요하지 않다면 사용하지 않는 것이 좋다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(15)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">커서 사용</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">되도록이면 임시&nbsp;</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">테이블이나 테이블 변수를</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">&nbsp;이용하여야 한다</span><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(16)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">SELECT 구문</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">컬럼을 지정해야 한다. 그렇지 않으면 모든 컬럼을 가져오게 되어서 레코드셋이 불필요하게 가득차게 된다.</span></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><b style="" _foo="font-family: 돋움; line-height: 1.5;"><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(17)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">SELECT INTO</span></b></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;" _foo="font-family: 굴림, gulim; font-size: 10pt;">SELECT * INTO</span></span><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px;">는 각 로우들의 입력 과정이 로그로 기록 되지 않으므로 로그로 기록되는 INSERT보다는 가끔 몇 배나 빨리 처리 된다.&nbsp;</span></span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">그렇지만 이 명령은 시스템 테이블에 락을 걸어 둘 수 있으므로 주의하여 사용해야 한다.</span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="" _foo="font-family: 돋움;"><b><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(18)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">임시&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">테이블 대신에 사용자 테이블&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">변수를 사용하라</span></b></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">임시&nbsp;테이블은 저장프로시저를 다시 컴파일 하지만 테이블 변수는 저장프로시저를 다시 컴파일 하지&nbsp;</span><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;">않는다.</span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><span style="font-size:9pt;" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim;"><br></span></p><p style="background-color: rgb(255, 255, 255);" _foo="text-align: justify; background-color: rgb(255, 255, 255);"><b><span style="" _foo="font-family: 돋움;"><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">(19)&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">임시&nbsp;</span><span style="font-size:10pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 10pt; color: rgb(0, 158, 37);">테이블을 사용해야 한다면&nbsp;</span></span><span style="font-size:9pt;color: rgb(0, 158, 37);" _foo="font-family: 굴림, gulim; font-size: 13.3333px; line-height: 20px; color: rgb(0, 158, 37);">KEEPFIXED PLAN 힌트 옵션을 이용하라</span></b></p><div><span style="font-size:9pt;background-color: rgb(255, 255, 255);" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim; text-align: justify; background-color: rgb(255, 255, 255);">임시 테이블로 부터 레코드를 얻어오는 동안 KEEPFIXED PLAN 힌트 옵션을 이용하라. 쿼리가 이 힌트를 담고 있다면 그것의 계획이 재컴파일 되지 않는다.</span></div><div><span style="font-size:9pt;background-color: rgb(255, 255, 255);" _foo="font-size: 13.3333px; line-height: 20px; font-family: 굴림, gulim; text-align: justify; background-color: rgb(255, 255, 255);"></span></div><table class="__se_tbl" border="0" cellpadding="0" cellspacing="1" style="font-family: 돋움; font-size: 13.3333px; line-height: 24px; background-color: rgb(166, 188, 209);"><tbody><tr><td class="" style="padding: 3px 4px 2px; width: 731px; background-color: rgb(241, 245, 249);"><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">CREATE PROCEDURE my_proc</span></span></p><p><span style="" _foo="font-family: 굴림, gulim;"><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px;">AS</span></span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">CREATE TABLE #t (</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">f_Idx</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;INT )</span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT * FROM #t</span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">INSERT #t SELECT * FROM tbl_Test</span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">SELECT COUNT(*) FROM #t WHERE&nbsp;</span><span style="font-size:9pt;" _foo="font-family: 굴림, gulim; font-size: 12px; line-height: 18px;">f_Idx</span><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">&nbsp;= 37</span></p><p><span style="font-size:9pt;" _foo="font-size: 12px; line-height: 18px; font-family: 굴림, gulim;">OPTION (KEEPFIXED PLAN)</span></p></td></tr></tbody></table>


	</div>
